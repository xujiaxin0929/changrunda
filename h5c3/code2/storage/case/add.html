<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>学生档案</title>
	<style>
		body {
			margin: 0;
			padding: 0 0 40px;
			background-color: #F7F7F7;
			font-family: '微软雅黑';
		}

		form {
			max-width: 640px;
			width: 100%;
			margin: 24px auto;
			font-size: 28px;
		}

		label {
			display: block;
			margin: 10px 10px 15px;
			font-size: 24px;
		}

		input {
			display: block;
			width: 100%;
			height: 40px;
			font-size: 22px;
			margin-top: 10px;
			padding: 6px 10px;
			color: #333;
			border: 1px solid #CCC;
			box-sizing: border-box;
		}

		.btn {
			margin-top: 30px;
		}

		.btn input {
			color: #FFF;
			background-color: green;
			border: 0 none;
			outline: none;
			cursor: pointer;
		}

		input[type="file"] {
			/*opacity: 0;*/
			width: 120px;
			position: absolute;
			right: 0;
			z-index: 9;
		}

		.import {
			height: 40px;
			position: relative;
		}

	</style>
</head>
<body>
	<form action="">
		<fieldset>
			<legend>学生档案</legend>
			<label for="">
				姓名: <input type="text" name="name" autofocus placeholder="请输入姓名">
			</label>
			<label for="">
				性别: <input type="text" name="sex" autofocus placeholder="请输入性别">
			</label>
			<label for="">
				年龄: <input type="text" name="age" autofocus placeholder="请输入年龄">
			</label>
			<label for="">
				手机号码: <input type="tel" name="phone" placeholder="请输入手机号码">
			</label>
			<label for="">
				邮箱地址: <input type="email" name="email" placeholder="请输入邮箱地址">
			</label>
			<label for="">
				所属学院: <input type="text" name="subject" list="course" placeholder="前端与移动开发学院">
				<datalist id="course">
					<option value="前端与移动开发"></option>
					<option value="PHP"></option>
					<option value="JAVA"></option>
					<option value="Android"></option>
					<option value="IOS"></option>
					<option value="UI设计"></option>
					<option value="C++"></option>
				</datalist>
			</label>
			<label for="">
				入学成绩: <input type="number" name="score" max="100" id="score" step="10" value="80">
			</label>
			<label for="">
				入学日期: <input type="date" name="date_start" value="2016-01-01">
			</label>
			<label for="">
				毕业时间: <input type="date" name="date_end" value="2016-05-01">
			</label>
			<label for="" class="btn">
				<input type="button" value="保存">
			</label>
			<label for="" class="import">
				<input type="file">
			</label>
		</fieldset>
	</form>
	<script src="./js/jquery.min.js"></script>
	<script type="text/javascript">

		$(".import input").on("change" ,function(){
			var filelist = this.files;
			var filereader = new FileReader();
			filereader.readAsText(filelist[0]);

			filereader.onload = function(){
				var res = filereader.result;
				localStorage.setItem("list",res);
			}
		})
		//导入的方式
		// $(".import input").on("change",function(){
		// 	var fileList = this.files;
			
		// 	//读取器
		// 	var reader = new FileReader;
		// 	reader.readAsText(fileList[0]);
			
		// 	reader.onload = function(){
		// 		//返回一个结果
		// 		var result = reader.result;
		// 		console.log(result);
		// 		localStorage.setItem("list",result);
		// 	}
			
		// })
		
		$(".btn input").on("click",function(){
			var info = $("form").serializeArray();

			console.log(info);

			var tmp = {};
			$.each(info,function(key,val){
				tmp[val.name] = val.value;
			})
			console.log(tmp);

			var list = localStorage.getItem("list");
			list = list && JSON.parse(list);

			if(list)
			{
				list.push(tmp);
				localStorage.setItem("list",JSON.stringify(list));
			}
			else{
				localStorage.setItem("list",[tmp]);
			}
		})


// 		$(".btn input").on("click",function(){
// 			var data = $("form").serializeArray();
// //			var data = $("form").serializeArray();
// 			//定义一个对象
// 			var temp = {};
// 			//通过循环重新组织一个数组对象方便后期处理
// 			$.each(data,function(key,val){
// 				console.log(val);
// 				temp[val.name] = val.value;
// 			})
// 			//从本地存储中取回数据
// 			var list = localStorage.getItem("list");
// 			list = list && JSON.parse(list);
			
// 			if(list)
// 			{
// 				//如果存在数据，讲新添加的数据追加到原来的数据后面
// 				console.log(temp);
// 				list.push(temp);
// 				localStorage.setItem("list",JSON.stringify(list));
// 			}
// 			else{
// 				//如果没有数据，将数据转换成数组 然后再转换成字符串存储到本地
// 				localStorage.setItem(JSON.stringify([temp]));
// 			}
// 			return false;
// 		})
	</script>
	
	
	

</body>
</html>