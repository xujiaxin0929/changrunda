<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>学生档案</title>
	<style>
		body {
			margin: 0;
			padding: 0 0 40px;
			background-color: #F7F7F7;
			font-family: '微软雅黑';
		}

		form {
			max-width: 640px;
			width: 100%;
			margin: 24px auto;
			font-size: 28px;
		}

		label {
			display: block;
			margin: 10px 10px 15px;
			font-size: 24px;
		}

		input {
			display: block;
			width: 100%;
			height: 40px;
			font-size: 22px;
			margin-top: 10px;
			padding: 6px 10px;
			color: #333;
			border: 1px solid #CCC;
			box-sizing: border-box;
		}

		.btn {
			margin-top: 30px;
		}

		.btn input {
			color: #FFF;
			background-color: green;
			border: 0 none;
			outline: none;
			cursor: pointer;
		}

		input[type="file"] {
			/*opacity: 0;*/
			width: 120px;
			position: absolute;
			right: 0;
			z-index: 9;
		}

		.import {
			height: 40px;
			position: relative;
		}

	</style>
</head>
<body>
	<form action="">
		<fieldset>
			<legend>学生档案</legend>
			<label for="">
				姓名: <input type="text" name="name" autofocus placeholder="请输入姓名">
			</label>
			<label for="">
				性别: <input type="text" name="sex" autofocus placeholder="请输入性别">
			</label>
			<label for="">
				年龄: <input type="text" name="age" autofocus placeholder="请输入年龄">
			</label>
			<label for="">
				手机号码: <input type="tel" name="phone" placeholder="请输入手机号码">
			</label>
			<label for="">
				邮箱地址: <input type="email" name="email" placeholder="请输入邮箱地址">
			</label>
			<label for="">
				所属学院: <input type="text" name="subject" list="course" placeholder="前端与移动开发学院">
				<datalist id="course">
					<option value="前端与移动开发"></option>
					<option value="PHP"></option>
					<option value="JAVA"></option>
					<option value="Android"></option>
					<option value="IOS"></option>
					<option value="UI设计"></option>
					<option value="C++"></option>
				</datalist>
			</label>
			<label for="">
				入学成绩: <input type="number" name="score" max="100" id="score" step="10" value="80">
			</label>
			<label for="">
				入学日期: <input type="date" name="date_start" value="2016-01-01">
			</label>
			<label for="">
				毕业时间: <input type="date" name="date_end" value="2016-05-01">
			</label>
			<label for="" class="btn">
				<input type="button" value="保存">
			</label>
			<label for="" class="import">
				<input type="file">
			</label>
		</fieldset>
	</form>
	<script src="./js/jquery.min.js"></script>
	<script type="text/javascript">

	// 通过上传文件的方式，把本地文件的内容保存起来

	// 绑定事件
	$(".import input").on("change",function(){
		var fs = $(this)[0].files;

		// 定义一个读取器
		var reader = new FileReader();

		// 以文本的方式读取文件
		reader.readAsText(fs[0]);

		// 加载后处理数据
		reader.onload=function(){
			var res = reader.result;
			console.log(res);

			// 保存到 localStorage
			localStorage.setItem("list",res);
		}
	})

	// 单独保存数据

	$(".btn input").on("click",function(){
		// serializeArray() jquery的方法主要是获取表单中的数据，好处是直接转换成数组了
		var data = $("form").serializeArray();
		//console.log(data);

		var temp = {};
		$.each(data,function(i,obj){
			console.log(obj);
			temp[obj.name] = obj.value;
		});
		console.log(temp);

		// 如果已经有数据了，应该在原有的数据上追加数据
		// 如果没有数据，直接保存

		var list = localStorage.getItem("list");

		list = list && JSON.parse(list);
		console.log(list);
		if(list)
		{
			list.push(temp);
			list = JSON.stringify(list);
			console.log(list);
			localStorage.setItem("list",list);
		}
		else{
			temp = [temp];
			localStorage.setItem("list",JSON.stringify(temp));
		}


	})

	</script>
	
	
	

</body>
</html>